// This is your Prisma schema file
// Learn more: https://pris.ly/d/prisma-schema

generator client {
  provider        = "prisma-client-js"
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
}

// ============================================
// ENUMS
// ============================================

enum Level {
  BEGINNER
  INTERMEDIATE
  ADVANCED
}

enum ExamType {
  TOEFL
  IELTS
  BOTH
}

enum Difficulty {
  B1
  B2
  C1
}

enum ProgressStatus {
  NEW
  LEARNING
  MASTERED
}

// ============================================
// MODELS
// ============================================

model User {
  id         String     @id @default(uuid())
  email      String     @unique
  name       String?
  level      Level      @default(BEGINNER)
  dailyGoal  Int        @default(5)
  streak     Int        @default(0)
  createdAt  DateTime   @default(now())
  updatedAt  DateTime   @updatedAt
  
  // Relations
  progress   Progress[]
  
  @@index([email])
  @@map("users")
}

model Word {
  id              Int        @id @default(autoincrement())
  term            String     @unique
  translation     String     // Turkish translation
  definition      String     @db.Text
  exampleSentence String     @db.Text
  audioUrl        String?
  examType        ExamType   @default(BOTH)
  difficulty      Difficulty @default(B2)
  createdAt       DateTime   @default(now())
  updatedAt       DateTime   @updatedAt
  
  // Relations
  progress        Progress[]
  
  @@index([examType])
  @@index([difficulty])
  @@index([term])
  @@map("words")
}

model Progress {
  id         Int            @id @default(autoincrement())
  userId     String
  wordId     Int
  status     ProgressStatus @default(NEW)
  nextReview DateTime       @default(now())
  reviewCount Int           @default(0)
  createdAt  DateTime       @default(now())
  updatedAt  DateTime       @updatedAt
  
  // Relations
  user       User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  word       Word           @relation(fields: [wordId], references: [id], onDelete: Cascade)
  
  @@unique([userId, wordId])
  @@index([userId, status])
  @@index([nextReview])
  @@map("progress")
}
